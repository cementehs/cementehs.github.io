<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据管理后台 | 水泥安环智脑</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="icon" type="image/x-icon" href="images/logo/favicon.ico">

    <!-- 添加 Chart.js 图表库 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- 添加JSZip库支持 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- 引入 crypto-js 库用于安全地哈希密码 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        // 验证Chart.js是否加载
        console.log('Chart.js 加载状态:', typeof Chart);
        if (typeof Chart === 'undefined') {
            console.error('Chart.js 未正确加载！');
            // 尝试从另一个CDN加载
            var script = document.createElement('script');
            script.src = 'https://cdn.bootcdn.net/ajax/libs/Chart.js/3.9.1/chart.min.js';
            script.onload = function() {
                console.log('Chart.js 从备用CDN加载成功');
            };
            script.onerror = function() {
                console.error('备用CDN也加载失败');
            };
            document.head.appendChild(script);
        } else {
            console.log('Chart.js 已正确加载');
        }
    </script>
</head>
<body>
    <!-- 登录页面 -->
    <div id="login-page" class="admin-page">
        <div class="login-container">
            <div class="login-header">
                <img src="images/logo/logo.png" alt="水泥安环智脑 Logo">
                <h1>数据管理后台</h1>
                <p>网站运营方专用</p>
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="username">用户名</label>
                    <input type="text" id="username" placeholder="请输入用户名" required>
                </div>
                
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" placeholder="请输入密码" required>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="remember">
                        <span>记住登录状态</span>
                    </label>
                </div>
                
                <div class="form-submit">
                    <button type="submit" class="btn btn-primary btn-large">登录</button>
                </div>
                
                <div class="login-hint">
                    <p>默认账号：admin / 密码：</p>
                    <p>首次登录后请及时修改密码</p>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 主管理页面（登录后显示） -->
    <div id="dashboard-page" class="admin-page" style="display: none;">
        <!-- 顶部导航 -->
        <nav class="admin-nav">
            <div class="nav-container">
                <div class="nav-brand">
                    <img src="images/logo/logo.png" alt="Logo">
                    <span>数据管理后台</span>
                </div>
                
                <div class="nav-user">
                    <span id="current-user">管理员</span>
                    <button onclick="openChangePasswordModal()" class="btn btn-secondary" style="margin-right: 10px;">
                        🔑 修改密码
                    </button>
                    <button onclick="fixDataTypes(); location.reload();" class="btn btn-warning" style="margin-right: 10px;">
                        🔧 修复数据类型
                    </button>
                    <button onclick="createComprehensiveTestData()" class="btn btn-info" style="margin-right: 10px;">
                        📊 生成图表数据
                    </button>
                    <button onclick="refreshCurrentPage()" class="btn btn-secondary" style="margin-right: 10px;">
                        🔄 刷新
                    </button>
                    <!-- 在导航栏的按钮区域添加 -->
                    <!-- 修改这一行 -->
                    <button onclick="manualSyncContactData()" class="btn btn-info" style="margin-right: 10px;">
                        🔄 同步合作洽谈数据
                    </button>
                    <button id="logout-btn" class="btn btn-secondary">退出登录</button>
                </div>
            </div>
        </nav>
        
        <!-- 侧边栏 -->
        <div class="admin-sidebar">
            <div class="sidebar-menu">
                <a href="#dashboard" class="menu-item active">
                    <span class="menu-icon">📊</span>
                    <span class="menu-text">数据概览</span>
                </a>
                
                <a href="#consultations" class="menu-item">
                    <span class="menu-icon">📅</span>
                    <span class="menu-text">预约咨询</span>
                    <span class="menu-badge" id="consultation-count">0</span>
                </a>
                
                <a href="#wechat" class="menu-item">
                    <span class="menu-icon">💬</span>
                    <span class="menu-text">微信咨询</span>
                    <span class="menu-badge" id="wechat-count">0</span>
                </a>
                
                <a href="#partnership" class="menu-item">
                    <span class="menu-icon">🤝</span>
                    <span class="menu-text">合作洽谈</span>
                    <span class="menu-badge" id="partnership-count">0</span>
                </a>
                
                <a href="#other" class="menu-item">
                    <span class="menu-icon">📧</span>
                    <span class="menu-text">其他咨询</span>
                    <span class="menu-badge" id="other-count">0</span>
                </a>
                
                <a href="#export" class="menu-item">
                    <span class="menu-icon">📥</span>
                    <span class="menu-text">数据导出</span>
                </a>
                
                <a href="#settings" class="menu-item">
                    <span class="menu-icon">⚙️</span>
                    <span class="menu-text">系统设置</span>
                </a>
            </div>
        </div>
        
        <!-- 主内容区 -->
        <div class="admin-content">
            <!-- 数据概览 -->
            <div id="dashboard" class="content-section active">
                <div class="section-header">
                    <h1>数据概览</h1>
                    <p>最近30天的数据统计</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">📊</div>
                        <div class="stat-info">
                            <h3>总提交量</h3>
                            <div class="stat-number" id="total-submissions">0</div>
                            <div class="stat-change">
                                <span class="change-up">↑ 12%</span> 较上月
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">📅</div>
                        <div class="stat-info">
                            <h3>今日新增</h3>
                            <div class="stat-number" id="today-submissions">0</div>
                            <div class="stat-change">
                                <span class="change-up">↑ 3</span> 较昨日
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">📈</div>
                        <div class="stat-info">
                            <h3>转化率</h3>
                            <div class="stat-number" id="conversion-rate">0%</div>
                            <div class="stat-change">
                                <span class="change-up">↑ 2%</span> 提升
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">⏰</div>
                        <div class="stat-info">
                            <h3>平均响应时间</h3>
                            <div class="stat-number" id="avg-response-time">0h</div>
                            <div class="stat-change">
                                <span class="change-down">↓ 1.5h</span> 改善
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-charts">
                    <div class="chart-container">
                        <h3>提交趋势</h3>
                        <div class="chart-container-inner">
                            <canvas id="submission-chart" style="display: none;"></canvas>
                            <div class="chart-loading" id="submission-loading">
                                图表加载中...
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>咨询类型分布</h3>
                        <div class="chart-container-inner">
                            <canvas id="type-chart" style="display: none;"></canvas>
                            <div class="chart-loading" id="type-loading">
                                图表加载中...
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="recent-submissions">
                    <h3>最近提交</h3>
                    <div class="table-container" style="width: 100%; overflow-x: auto;">
                        <table id="recent-table" style="width: 100%; table-layout: fixed;">
                            <thead>
                                <tr>
                                    <th style="width: 18%">提交时间</th>
                                    <th style="width: 12%">姓名</th>
                                    <th style="width: 20%">公司</th>
                                    <th style="width: 15%">咨询类型</th>
                                    <th style="width: 12%">状态</th>
                                    <th style="width: 23%">操作</th>
                                </tr>
                            </thead>
                            <tbody id="recent-table-body">
                                <!-- 数据动态加载 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- 预约咨询列表 -->
            <div id="consultations" class="content-section">
                <div class="section-header">
                    <h1>预约咨询管理</h1>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportData('consultation')">
                            <span>📥</span> 导出数据
                        </button>
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <span>🔄</span> 刷新
                        </button>
                    </div>
                </div>
                
                <!-- 批量操作工具栏 -->
                <div id="batch-toolbar" class="batch-toolbar" style="display: none;">
                    <div class="batch-info">
                        <span id="selected-count">0</span> 项被选中
                    </div>
                    <div class="batch-actions">
                        <button class="btn btn-sm btn-secondary" onclick="clearSelection()">
                            <span>✖️</span> 取消选择
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="batchDeleteConfirm()">
                            <span>🗑️</span> 批量删除
                        </button>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>状态筛选：</label>
                        <select id="status-filter" onchange="filterConsultations()">
                            <option value="all">全部状态</option>
                            <option value="pending">待处理</option>
                            <option value="contacted">已联系</option>
                            <option value="scheduled">已安排</option>
                            <option value="completed">已完成</option>
                            <option value="cancelled">已取消</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>时间范围：</label>
                        <input type="date" id="date-from" onchange="filterConsultations()">
                        <span>至</span>
                        <input type="date" id="date-to" onchange="filterConsultations()">
                    </div>
                    
                    <div class="filter-group">
                        <input type="text" id="search-input" placeholder="搜索姓名、公司..." 
                               onkeyup="searchConsultations()">
                    </div>
                </div>
                
                <div class="table-container" style="width: 100%; overflow-x: auto;">
                    <table class="data-table" style="width: 100%; min-width: 1200px;">
                        <thead>
                            <tr>
                                <th style="width: 60px; min-width: 60px;"><input type="checkbox" id="select-all-consultations" onclick="toggleSelectAll(this)"></th>
                                <th style="width: 15%">提交时间</th>
                                <th style="width: 10%">姓名</th>
                                <th style="width: 15%">公司</th>
                                <th style="width: 10%">职位</th>
                                <th style="width: 15%">感兴趣服务</th>
                                <th style="width: 15%">期望时间</th>
                                <th style="width: 10%">状态</th>
                                <th style="width: 10%">操作</th>
                            </tr>
                        </thead>
                        <tbody id="consultation-table-body">
                            <!-- 数据动态加载 -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <button class="page-btn" onclick="prevPage()">上一页</button>
                    <span id="page-info">第1页，共1页</span>
                    <button class="page-btn" onclick="nextPage()">下一页</button>
                </div>
            </div>

            <!-- 微信咨询页面 -->
            <div id="wechat" class="content-section">
                <div class="section-header">
                    <h1>微信咨询管理</h1>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportData('wechat')">
                            <span>📥</span> 导出数据
                        </button>
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <span>🔄</span> 刷新
                        </button>
                    </div>
                </div>
                
                <!-- 批量操作工具栏 -->
                <div id="batch-toolbar-wechat" class="batch-toolbar" style="display: none;">
                    <div class="batch-info">
                        <span id="selected-wechat-count">0</span> 项被选中
                    </div>
                    <div class="batch-actions">
                        <button class="btn btn-sm btn-secondary" onclick="clearWechatSelection()">
                            <span>✖️</span> 取消选择
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="batchDeleteWechatConfirm()">
                            <span>🗑️</span> 批量删除
                        </button>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>状态筛选：</label>
                        <select id="wechat-status-filter" onchange="filterWechatSubmissions()">
                            <option value="all">全部状态</option>
                            <option value="pending">待处理</option>
                            <option value="contacted">已联系</option>
                            <option value="added">已添加</option>
                            <option value="cancelled">已取消</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>时间范围：</label>
                        <input type="date" id="wechat-date-from" onchange="filterWechatSubmissions()">
                        <span>至</span>
                        <input type="date" id="wechat-date-to" onchange="filterWechatSubmissions()">
                    </div>
                    
                    <div class="filter-group">
                        <input type="text" id="wechat-search-input" placeholder="搜索姓名、公司..." 
                            onkeyup="searchWechatSubmissions()">
                    </div>
                </div>
                
                <div class="table-container" style="width: 100%; overflow-x: auto;">
                    <table class="data-table" style="width: 100%; min-width: 1200px;">
                        <thead>
                            <tr>
                                <th style="width: 60px; min-width: 60px;"><input type="checkbox" id="select-all-wechat" onclick="toggleSelectAllWechat(this)"></th>
                                <th style="width: 15%">提交时间</th>
                                <th style="width: 10%">姓名</th>
                                <th style="width: 15%">公司</th>
                                <th style="width: 10%">职位</th>
                                <th style="width: 10%">行业</th>
                                <th style="width: 15%">添加目的</th>
                                <th style="width: 10%">状态</th>
                                <th style="width: 15%">操作</th>
                            </tr>
                        </thead>
                        <tbody id="wechat-table-body">
                            <!-- 数据动态加载 -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <button class="page-btn" onclick="prevWechatPage()">上一页</button>
                    <span id="wechat-page-info">第1页，共1页</span>
                    <button class="page-btn" onclick="nextWechatPage()">下一页</button>
                </div>
            </div>

            <!-- 合作洽谈页面 -->
            <div id="partnership" class="content-section">
                <div class="section-header">
                    <h1>合作洽谈管理</h1>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportData('partnership')">
                            <span>📥</span> 导出数据
                        </button>
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <span>🔄</span> 刷新
                        </button>
                    </div>
                </div>
                
                <!-- 批量操作工具栏 -->
                <div id="batch-toolbar-partnership" class="batch-toolbar" style="display: none;">
                    <div class="batch-info">
                        <span id="selected-partnership-count">0</span> 项被选中
                    </div>
                    <div class="batch-actions">
                        <button class="btn btn-sm btn-secondary" onclick="clearPartnershipSelection()">
                            <span>✖️</span> 取消选择
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="batchDeletePartnershipConfirm()">
                            <span>🗑️</span> 批量删除
                        </button>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>状态筛选：</label>
                        <select id="partnership-status-filter" onchange="filterPartnershipSubmissions()">
                            <option value="all">全部状态</option>
                            <option value="pending">待处理</option>
                            <option value="contacted">已联系</option>
                            <option value="negotiating">洽谈中</option>
                            <option value="agreed">已达成合作</option>
                            <option value="cancelled">已取消</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>合作类型：</label>
                        <select id="partnership-type-filter" onchange="filterPartnershipSubmissions()">
                            <option value="all">全部类型</option>
                            <option value="supplier">供应商</option>
                            <option value="channel">渠道合作伙伴</option>
                            <option value="joint">联合解决方案</option>
                            <option value="expert">专家网络</option>
                            <option value="other">其他合作</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <input type="text" id="partnership-search-input" placeholder="搜索公司、联系人..." 
                            onkeyup="searchPartnershipSubmissions()">
                    </div>
                </div>
                
                <div class="table-container" style="width: 100%; overflow-x: auto;">
                    <table class="data-table" style="width: 100%; min-width: 1200px;">
                        <thead>
                            <tr>
                                <th style="width: 60px; min-width: 60px;"><input type="checkbox" id="select-all-partnership" onclick="toggleSelectAllPartnership(this)"></th>
                                <th style="width: 15%">提交时间</th>
                                <th style="width: 10%">联系人</th>
                                <th style="width: 15%">公司</th>
                                <th style="width: 10%">职位</th>
                                <th style="width: 10%">公司类型</th>
                                <th style="width: 15%">合作类型</th>
                                <th style="width: 10%">状态</th>
                                <th style="width: 15%">操作</th>
                            </tr>
                        </thead>
                        <tbody id="partnership-table-body">
                            <!-- 数据动态加载 -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <button class="page-btn" onclick="prevPartnershipPage()">上一页</button>
                    <span id="partnership-page-info">第1页，共1页</span>
                    <button class="page-btn" onclick="nextPartnershipPage()">下一页</button>
                </div>
            </div>

            <!-- 其他咨询页面 -->
            <div id="other" class="content-section">
                <div class="section-header">
                    <h1>其他咨询管理</h1>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportData('other')">
                            <span>📥</span> 导出数据
                        </button>
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <span>🔄</span> 刷新
                        </button>
                    </div>
                </div>
                
                <!-- 批量操作工具栏 -->
                <div id="batch-toolbar-other" class="batch-toolbar" style="display: none;">
                    <div class="batch-info">
                        <span id="selected-other-count">0</span> 项被选中
                    </div>
                    <div class="batch-actions">
                        <button class="btn btn-sm btn-secondary" onclick="clearOtherSelection()">
                            <span>✖️</span> 取消选择
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="batchDeleteOtherConfirm()">
                            <span>🗑️</span> 批量删除
                        </button>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>类别筛选：</label>
                        <select id="other-category-filter" onchange="filterOtherSubmissions()">
                            <option value="all">全部类别</option>
                            <option value="product">产品与方案咨询</option>
                            <option value="price">服务报价与合同</option>
                            <option value="speech">演讲与培训邀请</option>
                            <option value="media">媒体合作</option>
                            <option value="career">招聘与职业机会</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>状态筛选：</label>
                        <select id="other-status-filter" onchange="filterOtherSubmissions()">
                            <option value="all">全部状态</option>
                            <option value="pending">待处理</option>
                            <option value="replied">已回复</option>
                            <option value="closed">已关闭</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <input type="text" id="other-search-input" placeholder="搜索主题、联系人..." 
                            onkeyup="searchOtherSubmissions()">
                    </div>
                </div>
                
                <div class="table-container" style="width: 100%; overflow-x: auto;">
                    <table class="data-table" style="width: 100%; min-width: 1200px;">
                        <thead>
                            <tr>
                                <th style="width: 60px; min-width: 60px;"><input type="checkbox" id="select-all-other" onclick="toggleSelectAllOther(this)"></th>
                                <th style="width: 15%">提交时间</th>
                                <th style="width: 10%">联系人</th>
                                <th style="width: 15%">公司</th>
                                <th style="width: 15%">咨询类别</th>
                                <th style="width: 15%">咨询主题</th>
                                <th style="width: 10%">状态</th>
                                <th style="width: 20%">操作</th>
                            </tr>
                        </thead>
                        <tbody id="other-table-body">
                            <!-- 数据动态加载 -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <button class="page-btn" onclick="prevOtherPage()">上一页</button>
                    <span id="other-page-info">第1页，共1页</span>
                    <button class="page-btn" onclick="nextOtherPage()">下一页</button>
                </div>
            </div>
            
            <!-- 数据导出页面 -->
            <div id="export" class="content-section">
                <div class="section-header">
                    <h1>数据导出</h1>
                    <p>导出不同格式的数据文件</p>
                </div>
                
                <div class="export-content">
                    <div class="export-intro">
                        <h2>📊 数据导出指南</h2>
                        <p>选择您需要的数据格式进行导出。所有数据均来自用户提交的表单。</p>
                        <ul>
                            <li><strong>CSV格式</strong>：适合在Excel中打开和分析</li>
                            <li><strong>Excel格式</strong>：保留格式，适合直接查看</li>
                            <li><strong>JSON格式</strong>：适合程序读取和数据处理</li>
                            <li><strong>PDF格式</strong>：适合打印和分享</li>
                        </ul>
                    </div>
                    
                    <div class="export-options">
                        <div class="export-card">
                            <div class="export-icon">📁</div>
                            <h3>导出全部数据</h3>
                            <p>导出所有类型的数据到单个文件</p>
                            <div class="export-actions">
                                <button class="btn btn-primary" onclick="exportAllData('csv')">
                                    <span>📥</span> CSV格式
                                </button>
                                <button class="btn btn-secondary" onclick="exportAllData('excel')">
                                    <span>📊</span> Excel格式
                                </button>
                                <button class="btn btn-secondary" onclick="exportAllData('json')">
                                    <span>📄</span> JSON格式
                                </button>
                            </div>
                        </div>
                        
                        <div class="export-card">
                            <div class="export-icon">📅</div>
                            <h3>按类型导出</h3>
                            <p>按咨询类型分别导出数据</p>
                            <div class="export-filters">
                                <div class="filter-group">
                                    <label>选择数据类型：</label>
                                    <select id="export-type-select">
                                        <option value="consultation">预约咨询</option>
                                        <option value="wechat">微信咨询</option>
                                        <option value="partnership">合作洽谈</option>
                                        <option value="other">其他咨询</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>时间范围：</label>
                                    <input type="date" id="export-date-from">
                                    <span>至</span>
                                    <input type="date" id="export-date-to">
                                </div>
                            </div>
                            <div class="export-actions">
                                <button class="btn btn-primary" onclick="exportByType()">
                                    <span>📥</span> 导出选定类型
                                </button>
                            </div>
                        </div>
                        
                        <div class="export-card">
                            <div class="export-icon">📋</div>
                            <h3>批量导出</h3>
                            <p>一次导出多个类型的数据</p>
                            <div class="export-checkboxes">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-consultation" checked>
                                    <span>预约咨询</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-wechat" checked>
                                    <span>微信咨询</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-partnership" checked>
                                    <span>合作洽谈</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-other" checked>
                                    <span>其他咨询</span>
                                </label>
                            </div>
                            <div class="export-actions">
                                <button class="btn btn-primary" onclick="batchExport()">
                                    <span>📦</span> 批量导出
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="export-stats">
                        <h3>📈 数据统计</h3>
                        <div class="stats-container">
                            <div class="stat-item">
                                <div class="stat-label">总数据量</div>
                                <div class="stat-number" id="export-total-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">预约咨询</div>
                                <div class="stat-number" id="export-consultation-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">微信咨询</div>
                                <div class="stat-number" id="export-wechat-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">合作洽谈</div>
                                <div class="stat-number" id="export-partnership-count">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">其他咨询</div>
                                <div class="stat-number" id="export-other-count">0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="export-history">
                        <h3>📋 导出记录</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>导出时间</th>
                                        <th>文件名</th>
                                        <th>数据量</th>
                                        <th>格式</th>
                                        <th>大小</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="export-history-body">
                                    <!-- 导出记录动态加载 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 系统设置页面 -->
            <div id="settings" class="content-section">
                <div class="section-header">
                    <h1>系统设置</h1>
                    <p>管理系统配置和安全设置</p>
                </div>
                
                <div class="settings-content">
                    <div class="settings-card">
                        <div class="settings-icon">🔐</div>
                        <h2>安全设置</h2>
                        <div class="settings-section">
                            <h3>密码管理</h3>
                            <p>修改管理员登录密码，建议定期更换以确保账户安全。</p>
                            <button class="btn btn-primary" onclick="openChangePasswordModal()">
                                🔑 修改管理员密码
                            </button>
                        </div>
                        
                        <div class="settings-section">
                            <h3>登录安全</h3>
                            <div class="settings-options">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="login-notification" checked>
                                    <span>启用登录提醒（邮件/短信通知）</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="login-ip-check">
                                    <span>启用IP地址检查</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="login-two-factor">
                                    <span>启用双重验证（推荐）</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-card">
                        <div class="settings-icon">💾</div>
                        <h2>数据管理</h2>
                        <div class="settings-section">
                            <h3>数据备份</h3>
                            <p>定期备份数据，防止数据丢失。</p>
                            <div class="settings-actions">
                                <button class="btn btn-primary" onclick="backupData()">
                                    💾 立即备份
                                </button>
                                <button class="btn btn-secondary" onclick="showBackupHistory()">
                                    📋 查看备份历史
                                </button>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>数据清理</h3>
                            <p>清理过期或无效数据，优化系统性能。</p>
                            <div class="settings-actions">
                                <button class="btn btn-warning" onclick="cleanOldData()">
                                    🗑️ 清理30天前数据
                                </button>
                                <button class="btn btn-danger" onclick="cleanAllTestData()">
                                    ⚠️ 清理所有测试数据
                                </button>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>数据统计</h3>
                            <div class="data-stats">
                                <div class="data-stat">
                                    <div class="data-stat-label">总数据量</div>
                                    <div class="data-stat-value" id="settings-total-data">0</div>
                                </div>
                                <div class="data-stat">
                                    <div class="data-stat-label">存储空间</div>
                                    <div class="data-stat-value" id="settings-storage-size">0 KB</div>
                                </div>
                                <div class="data-stat">
                                    <div class="data-stat-label">最后备份</div>
                                    <div class="data-stat-value" id="settings-last-backup">从未备份</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-card">
                        <div class="settings-icon">⚙️</div>
                        <h2>系统配置</h2>
                        <div class="settings-section">
                            <h3>通知设置</h3>
                            <div class="settings-options">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="email-notification" checked>
                                    <span>新咨询邮件通知</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="wechat-notification">
                                    <span>微信通知（需要配置）</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="sms-notification">
                                    <span>短信通知（需要配置）</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>显示设置</h3>
                            <div class="settings-options">
                                <div class="form-group">
                                    <label>每页显示数量：</label>
                                    <select id="page-size">
                                        <option value="10">10条</option>
                                        <option value="25">25条</option>
                                        <option value="50">50条</option>
                                        <option value="100">100条</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>主题颜色：</label>
                                    <select id="theme-color">
                                        <option value="blue">蓝色主题</option>
                                        <option value="green">绿色主题</option>
                                        <option value="purple">紫色主题</option>
                                        <option value="dark">深色主题</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>系统信息</h3>
                            <div class="system-info">
                                <div class="info-row">
                                    <span class="info-label">系统版本：</span>
                                    <span class="info-value">v1.2.0</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">最后更新：</span>
                                    <span class="info-value">2024-06-15</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">浏览器支持：</span>
                                    <span class="info-value">Chrome 90+, Firefox 88+, Safari 14+</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 详情模态框 -->
            <div class="modal" id="detail-modal">
                <div class="modal-content large">
                    <button class="modal-close" onclick="closeModal('detail-modal')">&times;</button>
                    <div class="modal-body">
                        <div id="detail-content">
                            <!-- 详情动态加载 -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 编辑状态模态框 -->
            <div class="modal" id="edit-modal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('edit-modal')">&times;</button>
                    <div class="modal-body">
                        <h2>更新状态</h2>
                        <form id="edit-form" onsubmit="handleEditSubmit(event)">
                            <input type="hidden" id="edit-id">
                            <input type="hidden" id="edit-type">
                            
                            <div class="form-group">
                                <label for="edit-status">状态</label>
                                <select id="edit-status" required>
                                    <option value="pending">待处理</option>
                                    <option value="contacted">已联系</option>
                                    <option value="scheduled">已安排</option>
                                    <option value="completed">已完成</option>
                                    <option value="cancelled">已取消</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-notes">处理备注</label>
                                <textarea id="edit-notes" rows="3" placeholder="记录处理情况..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-followup">跟进时间</label>
                                <input type="datetime-local" id="edit-followup">
                            </div>
                            
                            <div class="form-submit">
                                <button type="submit" class="btn btn-primary">保存</button>
                                <button type="button" class="btn btn-secondary" onclick="closeModal('edit-modal')">取消</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- 密码修改模态框 -->
            <div class="modal" id="change-password-modal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('change-password-modal')">&times;</button>
                    <div class="modal-body">
                        <h2>🔐 修改管理员密码</h2>
                        <p class="modal-hint">请谨慎操作，修改成功后需要重新登录。</p>
                        
                        <form id="change-password-form" novalidate>
                            <div class="form-group">
                                <label for="current-password">当前密码 *</label>
                                <input type="password" id="current-password" placeholder="请输入当前使用的密码" required>
                                <div class="field-hint">默认密码：AnHuan2024</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="new-password">新密码 *</label>
                                <input type="password" id="new-password" placeholder="至少6位，建议包含字母和数字" required minlength="6">
                                <div class="password-strength" id="password-strength">
                                    <span class="strength-text">密码强度：</span>
                                    <span class="strength-bar">
                                        <span class="strength-segment"></span>
                                        <span class="strength-segment"></span>
                                        <span class="strength-segment"></span>
                                    </span>
                                    <span class="strength-label" id="strength-label">弱</span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="confirm-password">确认新密码 *</label>
                                <input type="password" id="confirm-password" placeholder="请再次输入新密码" required>
                                <div class="field-hint" id="password-match-hint"></div>
                            </div>
                            
                            <div class="form-submit">
                                <button type="submit" class="btn btn-primary btn-large" id="submit-password-btn">
                                    💾 保存新密码
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="closeModal('change-password-modal')">
                                    取消
                                </button>
                            </div>
                            
                            <div class="form-footer">
                                <p><strong>安全提示：</strong>请勿使用过于简单的密码，并确保定期更换。</p>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- 删除确认模态框 -->
            <div class="modal" id="delete-confirm-modal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('delete-confirm-modal')">&times;</button>
                    <div class="modal-body">
                        <div class="delete-icon">⚠️</div>
                        <h2 id="delete-title">确认删除</h2>
                        <div id="delete-message">
                            <!-- 动态内容 -->
                        </div>
                        <div class="delete-actions">
                            <button class="btn btn-danger btn-large" onclick="executeDelete()">
                                <span>🗑️</span> 确认删除
                            </button>
                            <button class="btn btn-secondary" onclick="closeModal('delete-confirm-modal')">
                                <span>↶</span> 取消
                            </button>
                        </div>
                        <div class="delete-warning">
                            <p><strong>注意：</strong>删除操作无法自动恢复。重要数据建议先<a href="#" onclick="exportCurrentData()">导出备份</a>。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 删除成功提示（带撤销选项） -->
            <div id="undo-notification" class="undo-notification" style="display: none;">
                <div class="undo-content">
                    <span>✅ 数据删除成功</span>
                    <button onclick="undoLastDelete()" class="btn btn-sm btn-secondary">
                        <span>↶</span> 撤销
                    </button>
                    <button onclick="hideUndoNotification()" class="btn btn-sm btn-secondary">
                        ✖️
                    </button>
                </div>
            </div>

            <!-- 备份历史模态框 -->
            <div class="modal" id="backup-history-modal">
                <div class="modal-content large">
                    <button class="modal-close" onclick="closeModal('backup-history-modal')">&times;</button>
                    <div class="modal-body">
                        <h2>📋 备份历史记录</h2>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>备份时间</th>
                                        <th>备份名称</th>
                                        <th>数据量</th>
                                        <th>备份大小</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="backup-history-body">
                                    <!-- 备份记录动态加载 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>